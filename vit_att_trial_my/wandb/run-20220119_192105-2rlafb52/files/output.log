cpu
image : 0
Warning: target_layers is ignored in FullGrad. All bias layers will be used instead
C:\Users\USER\PycharmProjects\DL_project\venv\lib\site-packages\torch\nn\modules\module.py:1025: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
C:\Users\USER\PycharmProjects\DL_project\vit_att_trial\misc_functions.py:43: RuntimeWarning: invalid value encountered in true_divide
  gradient /= gradient.max()
Traceback (most recent call last):
  File "C:\Users\USER\PycharmProjects\DL_project\venv\lib\site-packages\PIL\Image.py", line 2813, in fromarray
    mode, rawmode = _fromarray_typemap[typekey]
KeyError: ((1, 1, 3), '<f4')
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "C:/Users/USER/PycharmProjects/DL_project/vit_att_trial/run_layer_cam.py", line 160, in <module>
    save_gradient_images(neg_sal, file_name_to_export + '_neg_sal')
  File "C:\Users\USER\PycharmProjects\DL_project\vit_att_trial\misc_functions.py", line 46, in save_gradient_images
    save_image(gradient, path_to_file)
  File "C:\Users\USER\PycharmProjects\DL_project\vit_att_trial\misc_functions.py", line 132, in save_image
    im = Image.fromarray(im)
  File "C:\Users\USER\PycharmProjects\DL_project\venv\lib\site-packages\PIL\Image.py", line 2815, in fromarray
    raise TypeError("Cannot handle this data type: %s, %s" % typekey) from e
TypeError: Cannot handle this data type: (1, 1, 3), <f4