image : 0
torch.Size([1, 3, 496, 512])
torch.Size([1, 64, 248, 256])
torch.Size([1, 64, 248, 256])
torch.Size([1, 64, 248, 256])
torch.Size([1, 64, 124, 128])
torch.Size([1, 64, 124, 128])
torch.Size([1, 128, 62, 64])
torch.Size([1, 256, 31, 32])
torch.Size([1, 512, 16, 16])
torch.Size([1, 512, 1, 1])
Traceback (most recent call last):
  File "run_layer_cam.py", line 101, in <module>
    cam = layer_cam.generate_cam(images, labels.item())
  File "/home/labs/testing/class57/OCTransformer/breakdown/testings/vit_att_trial/layer_cam.py", line 67, in generate_cam
    conv_output, model_output = self.extractor.forward_pass(input_image)
  File "/home/labs/testing/class57/OCTransformer/breakdown/testings/vit_att_trial/layer_cam.py", line 46, in forward_pass
    conv_output, x = self.forward_pass_on_convolutions(x)
  File "/home/labs/testing/class57/OCTransformer/breakdown/testings/vit_att_trial/layer_cam.py", line 33, in forward_pass_on_convolutions
    x = module(x)  # Forward
  File "/home/labs/testing/class57/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/labs/testing/class57/.local/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 103, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/labs/testing/class57/.local/lib/python3.8/site-packages/torch/nn/functional.py", line 1848, in linear
    return torch._C._nn.linear(input, weight, bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (512x1 and 512x4)